<!DOCTYPE html>
<html>
<head>
  <title>Tasks</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>

</head>
<body>
<div id="fb-root"></div>


<script>


        window.fbAsyncInit = function() {
          FB.init({
            appId      : '420162121354611', // App ID
            channelUrl : 'http://morning-rain-8661.herokuapp.com/channel.html', // Channel File
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true  // parse XFBML
          });

          setTimeout(function(){FB.api('/me', function(user) {
            if (user) {
              var image = document.getElementById('image');
              image.src = user.picture;
	var name = document.getElementById('name');
var d = new Date();
              name.innerHTML = 'Nombre: '+user.name+"\n Usuario: "+user.username+' \nEdad: '+(parseInt(d.getFullYear())-parseInt(user.birthday.substring(6)))+' \nCorreo: '+user.email;
            }
          });},2000);
        };

        // Load the SDK Asynchronously
        (function(d){
           var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
           if (d.getElementById(id)) {return;}
           js = d.createElement('script'); js.id = id; js.async = true;
           js.src = "//connect.facebook.net/en_US/all.js";
           ref.parentNode.insertBefore(js, ref);
         }(document));

	function post() {
                FB.api('/me/gradesdisp:Develop', 'post', { object: 'http://127.0.0.1:5000/ruby.html' }, function(response) {
  if (!response || response.error) {
    alert(response.error.message);
  } else {
    alert('Post ID: ' + response.id);
  }
});
            };
function post2(){
var body = 'Reading JS SDK documentation';
FB.api('/me/feed', 'post', { message: body }, function(response) {
  if (!response || response.error) {
    alert('Error occured');
  } else {
    alert('Post ID: ' + response.id);
  }
});
};


 


      </script>
<script src="https://connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript">FB.init();</script>
      
<div class="fb-login-button">Login with Facebook</div>
<form>
        <input type="button" value="Post something" onclick="post()" />
    </form>

<div align="center">
        <img id="image"/>
	 <div id="name"></div>
      </div>
<% flash.each do |name, msg| %>
<div id="flash_<%= name %>">
	<%= msg %>
</div>

<% end %>
<% if logged_in? %>
	<p> Logged in as <%= current_user.email %></p>
	<%= link_to "Logout", session_path(id:"current"), method: "delete" %>
<% else %>
	<%= link_to "Log in", new_session_path %>
	<%= link_to "Register", new_user_path %>
<% end %>

<%= yield %>


</body>
</html>
